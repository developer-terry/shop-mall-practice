webpackJsonp([13],{"+1JR":function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a={components:{},props:{},data:function(){return{attrGroupId:0,visible:!1,innerVisible:!1,relationAttrs:[],dataListSelections:[],dataForm:{key:""},dataList:[],pageIndex:1,pageSize:10,totalPage:0,dataListLoading:!1,innerdataListSelections:[]}},computed:{},watch:{},methods:{selectionChangeHandle:function(t){this.dataListSelections=t},innerSelectionChangeHandle:function(t){this.innerdataListSelections=t},addRelation:function(){this.getDataList(),this.innerVisible=!0},batchDeleteRelation:function(t){var n=this,e=[];this.dataListSelections.forEach(function(t){e.push({attrId:t.attrId,attrGroupId:n.attrGroupId})}),this.$http({url:this.$http.adornUrl("/product/attrgroup/attr/relation/delete"),method:"post",data:this.$http.adornData(e,!1)}).then(function(t){var e=t.data;0==e.code?(n.$message({type:"success",message:"删除成功"}),n.init(n.attrGroupId)):n.$message({type:"error",message:e.msg})})},relationRemove:function(t){var n=this,e=[];e.push({attrId:t,attrGroupId:this.attrGroupId}),this.$http({url:this.$http.adornUrl("/product/attrgroup/attr/relation/delete"),method:"post",data:this.$http.adornData(e,!1)}).then(function(t){var e=t.data;0==e.code?(n.$message({type:"success",message:"删除成功"}),n.init(n.attrGroupId)):n.$message({type:"error",message:e.msg})})},submitAddRealtion:function(){var t=this;if(this.innerVisible=!1,console.log("准备新增的数据",this.innerdataListSelections),this.innerdataListSelections.length>0){var n=[];this.innerdataListSelections.forEach(function(e){n.push({attrId:e.attrId,attrGroupId:t.attrGroupId})}),this.$http({url:this.$http.adornUrl("/product/attrgroup/attr/relation"),method:"post",data:this.$http.adornData(n,!1)}).then(function(n){0==n.data.code&&t.$message({type:"success",message:"新增关联成功"}),t.$emit("refreshData"),t.init(t.attrGroupId)})}},init:function(t){var n=this;this.attrGroupId=t||0,this.visible=!0,this.$http({url:this.$http.adornUrl("/product/attrgroup/"+this.attrGroupId+"/attr/relation"),method:"get",params:this.$http.adornParams({})}).then(function(t){var e=t.data;n.relationAttrs=e.data})},dialogClose:function(){},getDataList:function(){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/product/attrgroup/"+this.attrGroupId+"/noattr/relation"),method:"get",params:this.$http.adornParams({page:this.pageIndex,limit:this.pageSize,key:this.dataForm.key})}).then(function(n){var e=n.data;e&&0===e.code?(t.dataList=e.page.list,t.totalPage=e.page.totalCount):(t.dataList=[],t.totalPage=0),t.dataListLoading=!1})},sizeChangeHandle:function(t){this.pageSize=t,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(t){this.pageIndex=t,this.getDataList()}}},i={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("el-dialog",{attrs:{"close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(n){t.visible=n},closed:t.dialogClose}},[e("el-dialog",{attrs:{width:"40%",title:"选择属性",visible:t.innerVisible,"append-to-body":""},on:{"update:visible":function(n){t.innerVisible=n}}},[e("div",[e("el-form",{attrs:{inline:!0,model:t.dataForm},nativeOn:{keyup:function(n){if(!("button"in n)&&t._k(n.keyCode,"enter",13,n.key,"Enter"))return null;t.getDataList()}}},[e("el-form-item",[e("el-input",{attrs:{placeholder:"参数名",clearable:""},model:{value:t.dataForm.key,callback:function(n){t.$set(t.dataForm,"key",n)},expression:"dataForm.key"}})],1),t._v(" "),e("el-form-item",[e("el-button",{on:{click:function(n){t.getDataList()}}},[t._v("查询")])],1)],1),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList,border:""},on:{"selection-change":t.innerSelectionChangeHandle}},[e("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center"}}),t._v(" "),e("el-table-column",{attrs:{prop:"attrId","header-align":"center",align:"center",label:"属性id"}}),t._v(" "),e("el-table-column",{attrs:{prop:"attrName","header-align":"center",align:"center",label:"属性名"}}),t._v(" "),e("el-table-column",{attrs:{prop:"icon","header-align":"center",align:"center",label:"属性图标"}}),t._v(" "),e("el-table-column",{attrs:{prop:"valueSelect","header-align":"center",align:"center",label:"可选值列表"}})],1),t._v(" "),e("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,20,50,100],"page-size":t.pageSize,total:t.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}})],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(n){t.innerVisible=!1}}},[t._v("取 消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.submitAddRealtion}},[t._v("确认新增")])],1)]),t._v(" "),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-button",{attrs:{type:"primary"},on:{click:t.addRelation}},[t._v("新建关联")]),t._v(" "),e("el-button",{attrs:{type:"danger",disabled:t.dataListSelections.length<=0},on:{click:t.batchDeleteRelation}},[t._v("批量删除")]),t._v(" "),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.relationAttrs,border:""},on:{"selection-change":t.selectionChangeHandle}},[e("el-table-column",{attrs:{type:"selection","header-align":"center",align:"center",width:"50"}}),t._v(" "),e("el-table-column",{attrs:{prop:"attrId",label:"#"}}),t._v(" "),e("el-table-column",{attrs:{prop:"attrName",label:"属性名"}}),t._v(" "),e("el-table-column",{attrs:{prop:"valueSelect",label:"可选值"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("el-tooltip",{attrs:{placement:"top"}},[e("div",{attrs:{slot:"content"},slot:"content"},t._l(n.row.valueSelect.split(";"),function(n,a){return e("span",{key:a},[t._v("\n                    "+t._s(n)+"\n                    "),e("br")])})),t._v(" "),e("el-tag",[t._v(t._s(n.row.valueSelect.split(";")[0]+" ..."))])],1)]}}])}),t._v(" "),e("el-table-column",{attrs:{fixed:"right","header-align":"center",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(n){return[e("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){t.relationRemove(n.row.attrId)}}},[t._v("移除")])]}}])})],1)],1)],1)],1)],1)},staticRenderFns:[]};var r=e("VU/8")(a,i,!1,function(t){e("MP5Q")},"data-v-405e3bdc",null);n.default=r.exports},MP5Q:function(t,n,e){var a=e("UfHO");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e("rjj0")("64eb0428",a,!0)},UfHO:function(t,n,e){(t.exports=e("FZ+f")(!1)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});