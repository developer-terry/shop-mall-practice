webpackJsonp([2],{"3muG":function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},"5zde":function(n,t,e){e("zQR9"),e("qyJz"),n.exports=e("FeBl").Array.from},BO1k:function(n,t,e){n.exports={default:e("fxRn"),__esModule:!0}},Gu7T:function(n,t,e){"use strict";t.__esModule=!0;var a,o=e("c/Tr"),r=(a=o)&&a.__esModule?a:{default:a};t.default=function(n){if(Array.isArray(n)){for(var t=0,e=Array(n.length);t<n.length;t++)e[t]=n[t];return e}return(0,r.default)(n)}},"c/Tr":function(n,t,e){n.exports={default:e("5zde"),__esModule:!0}},fBQ2:function(n,t,e){"use strict";var a=e("evD5"),o=e("X8DO");n.exports=function(n,t,e){t in n?a.f(n,t,o(0,e)):n[t]=e}},fxRn:function(n,t,e){e("+tPU"),e("zQR9"),n.exports=e("g8Ux")},g8Ux:function(n,t,e){var a=e("77Pl"),o=e("3fs2");n.exports=e("FeBl").getIterator=function(n){var t=o(n);if("function"!=typeof t)throw TypeError(n+" is not iterable!");return a(t.call(n))}},pRlC:function(n,t,e){var a=e("3muG");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("rjj0")("1062d64c",a,!0)},qyJz:function(n,t,e){"use strict";var a=e("+ZMJ"),o=e("kM2E"),r=e("sB3e"),i=e("msXi"),s=e("Mhyx"),c=e("QRG4"),l=e("fBQ2"),d=e("3fs2");o(o.S+o.F*!e("dY0y")(function(n){Array.from(n)}),"Array",{from:function(n){var t,e,o,u,p=r(n),h="function"==typeof this?this:Array,g=arguments.length,f=g>1?arguments[1]:void 0,y=void 0!==f,v=0,m=d(p);if(y&&(f=a(f,g>2?arguments[2]:void 0,2)),void 0==m||h==Array&&s(m))for(e=new h(t=c(p.length));t>v;v++)l(e,v,y?f(p[v],v):p[v]);else for(u=m.call(p),e=new h;!(o=u.next()).done;v++)l(e,v,y?i(u,f,[o.value,v],!0):o.value);return e.length=v,e}})},sd0f:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=e("Gu7T"),o=e.n(a),r=e("BO1k"),i=e.n(r),s={data:function(){return{categoryDraggable:!1,updateCategories:[],maxLevel:0,dialogType:"",expandedKeys:[],defaultProps:{children:"children",label:"name"},categoryMenus:[],dialogVisible:!1,title:"",category:{catId:0,name:"",parentCid:0,catLevel:0,showStatus:1,sort:0,icon:"",productUnit:""},parentCids:[]}},methods:{handleNodeClick:function(n){console.log(n)},getCategoryMenus:function(){var n=this;this.$http({url:this.$http.adornUrl("/product/category/list/tree"),method:"get"}).then(function(t){var e=t.data;n.categoryMenus=e.data})},append:function(n){this.title="新增分類",this.dialogType="add",this.dialogVisible=!0,this.category.parentCid=n.catId,this.category.catLevel=parseInt(n.catLevel)+1},edit:function(n){var t=this;this.dialogType="edit",this.title="修改分類",this.dialogVisible=!0;var e=n.catId;this.$http({url:this.$http.adornUrl("/product/category/info/"+e),method:"get"}).then(function(n){var e=n.data.category;t.category.catId=e.catId,t.category.name=e.name,t.category.icon=e.icon,t.category.productUnit=e.productUnit,t.category.parentCid=e.parentCid})},submitData:function(){"add"==this.dialogType?this.addCategory():"edit"==this.dialogType&&this.editCategory()},addCategory:function(){var n=this,t=this.category.name;this.$http({url:this.$http.adornUrl("/product/category/save"),method:"post",data:this.$http.adornData(this.category,!1)}).then(function(e){e.data;n.$message({type:"success",message:"分類「"+t+"」新增成功"}),n.dialogVisible=!1,n.getCategoryMenus(),n.expandedKeys.push(n.category.parentCid)}).finally(function(){n.resetCategroy()})},editCategory:function(){var n=this,t=this.category,e=t.catId,a=t.name,o=t.icon,r=t.productUnit,i={catId:e,name:a,icon:o,productUnit:r};this.$http({url:this.$http.adornUrl("/product/category/update"),method:"post",data:this.$http.adornData(i,!1)}).then(function(t){t.data;n.$message({type:"success",message:"分類「"+a+"」更新成功"}),n.dialogVisible=!1,n.getCategoryMenus(),n.expandedKeys.push(n.category.parentCid)}).finally(function(){n.resetCategroy()})},resetCategroy:function(){this.category={catId:0,name:"",parentCid:0,catLevel:0,showStatus:1,sort:0,icon:"",productUnit:""}},remove:function(n,t){var e=this,a=t.name;this.$confirm("是否刪除「"+a+"」分類?","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then(function(){var o=[t.catId];e.$http({url:e.$http.adornUrl("/product/category/delete"),method:"post",data:e.$http.adornData(o,!1)}).then(function(t){t.data;e.$message({type:"success",message:"分類「"+a+"」刪除成功"}),e.getCategoryMenus(),e.expandedKeys.push(n.parent.data.catId)})}).catch(function(){e.$message({type:"info",message:"取消删除"})})},allowDrop:function(n,t,e){this.countNodeLevel(n);var a=Math.abs(this.maxLevel-n.level)+1;return"inner"==e?a+t.level<=3:a+t.parent.level<=3},countNodeLevel:function(n){if(n.childNodes&&n.childNodes.length>0){var t=!0,e=!1,a=void 0;try{for(var o,r=i()(n.childNodes);!(t=(o=r.next()).done);t=!0){var s=o.value;s.level>this.maxLevel&&(this.maxLevel=s.level),this.countNodeLevel(s)}}catch(n){e=!0,a=n}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}}},handleDrop:function(n,t,e){console.log("tree drop: ",n,t,e);var a="inner"==e?t.data.catId:t.parent.data.catId;this.parentCid=a||0;var o="inner"==e?t.childNodes:t.parent.childNodes;for(var r in o){var i=o[r].data;if(i.catId==n.data.catId){var s=n.level;o[r].level!=s&&(s=o[r].level,this.updateChildNodeLevel(o[r])),i.catLevel=s,i.parentCid=this.parentCid}this.parentCids.push(this.parentCid),i.sort=o.length-r,this.updateCategories.push(i),this.maxLevel=0}},updateChildNodeLevel:function(n){if(n&&n.childNodes&&n.childNodes.length>0){var t=!0,e=!1,a=void 0;try{for(var o,r=i()(n.childNodes);!(t=(o=r.next()).done);t=!0){var s=o.value,c=s.data;c.catLevel=s.level,this.updateCategories.push(c),this.updateChildNodeLevel(s)}}catch(n){e=!0,a=n}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}}},batchUpdateCategorySorts:function(){var n=this;this.$http({url:this.$http.adornUrl("/product/category/update/sort"),method:"post",data:this.$http.adornData(this.updateCategories,!1)}).then(function(t){var e;t.data;n.$message({type:"success",message:"選單順序修改成功"}),n.getCategoryMenus(),(e=n.expandedKeys).push.apply(e,o()(n.parentCids))}).finally(function(){n.updateCategories=[],n.parentCid=0,n.parentCids=[]})},batchDeleteCategories:function(){var n=this,t=this.$refs.categoryMenuTree.getCheckedNodes(),e=[],a=[],o=!0,r=!1,s=void 0;try{for(var c,l=i()(t);!(o=(c=l.next()).done);o=!0){var d=c.value;e.push(d.catId),a.push(d.name)}}catch(n){r=!0,s=n}finally{try{!o&&l.return&&l.return()}finally{if(r)throw s}}this.$confirm("是否批量刪除「"+a+"」分類?","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then(function(){n.$http({url:n.$http.adornUrl("/product/category/delete"),method:"post",data:n.$http.adornData(e,!1)}).then(function(t){t.data;n.$message({type:"success",message:"分類批量刪除成功"}),n.getCategoryMenus()})}).catch(function(){n.$message({type:"info",message:"取消删除"})})}},created:function(){this.getCategoryMenus()}},c={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[e("el-switch",{attrs:{"active-text":"開啟拖曳","inactive-text":"關閉拖曳"},model:{value:n.categoryDraggable,callback:function(t){n.categoryDraggable=t},expression:"categoryDraggable"}}),n._v(" "),n.categoryDraggable?e("el-button",{on:{click:n.batchUpdateCategorySorts}},[n._v("批量保存")]):n._e(),n._v(" "),e("el-button",{attrs:{type:"danger"},on:{click:n.batchDeleteCategories}},[n._v("批量刪除")]),n._v(" "),e("el-tree",{ref:"categoryMenuTree",attrs:{data:n.categoryMenus,props:n.defaultProps,"expand-on-click-node":!1,"show-checkbox":"","node-key":"catId","default-expanded-keys":n.expandedKeys,draggable:n.categoryDraggable,"allow-drop":n.allowDrop},on:{"node-click":n.handleNodeClick,"node-drop":n.handleDrop},scopedSlots:n._u([{key:"default",fn:function(t){var a=t.node,o=t.data;return e("span",{staticClass:"custom-tree-node"},[e("span",[n._v(n._s(a.label))]),n._v(" "),e("span",[a.level<=2?e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return n.append(o)}}},[n._v("\n          Append\n        ")]):n._e(),n._v(" "),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return n.edit(o)}}},[n._v("\n          Edit\n        ")]),n._v(" "),a.childNodes&&0==a.childNodes.length?e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return n.remove(a,o)}}},[n._v("\n          Delete\n        ")]):n._e()],1)])}}])}),n._v(" "),e("el-dialog",{attrs:{title:"提示",visible:n.dialogVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){n.dialogVisible=t}}},[e("el-form",{attrs:{model:n.category}},[e("el-form-item",{attrs:{label:"分類名稱"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:n.category.name,callback:function(t){n.$set(n.category,"name",t)},expression:"category.name"}})],1),n._v(" "),e("el-form-item",{attrs:{label:"圖標"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:n.category.icon,callback:function(t){n.$set(n.category,"icon",t)},expression:"category.icon"}})],1),n._v(" "),e("el-form-item",{attrs:{label:"計量單位"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:n.category.productUnit,callback:function(t){n.$set(n.category,"productUnit",t)},expression:"category.productUnit"}})],1)],1),n._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){n.dialogVisible=!1}}},[n._v("取消")]),n._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:n.submitData}},[n._v("確定")])],1)],1)],1)},staticRenderFns:[]};var l=e("VU/8")(s,c,!1,function(n){e("pRlC")},null,null);t.default=l.exports}});